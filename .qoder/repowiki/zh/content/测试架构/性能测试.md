
# 性能测试

<cite>
**本文档引用的文件**
- [performance_baseline.test.ts](file://tests/performance/performance_baseline.test.ts)
- [performance_large_insert.test.ts](file://tests/performance/performance_large_insert.test.ts)
- [property_index_performance.test.ts](file://tests/performance/property_index_performance.test.ts)
- [index.ts](file://src/benchmark/index.ts)
- [suites.ts](file://src/benchmark/suites.ts)
- [types.ts](file://src/benchmark/types.ts)
- [runner.ts](file://src/benchmark/runner.ts)
- [reporter.ts](file://src/benchmark/reporter.ts)
- [basic.mjs](file://benchmarks/basic.mjs)
- [comprehensive.mjs](file://benchmarks/comprehensive.mjs)
- [framework.mjs](file://benchmarks/framework.mjs)
- [insert_scan.mjs](file://benchmarks/insert_scan.mjs)
- [path_agg.mjs](file://benchmarks/path_agg.mjs)
- [quick.mjs](file://benchmarks/quick.mjs)
</cite>

## 目录
1. [简介](#简介)
2. [性能监控体系](#性能监控体系)
3. [基线性能测试 (baseline)](#基线性能测试-baseline)
4. [大规模插入吞吐量测试 (large_insert)](#大规模插入吞吐量测试-large_insert)
5. [属性索引查询性能评估](#属性索引查询性能评估)
6. [性能瓶颈识别与配置对比](#性能瓶颈识别与配置对比)
7. [运行基准测试与提交报告](#运行基准测试与提交报告)
8. [结论](#结论)

## 简介
本文档旨在全面介绍 SynapseDB 的性能测试框架，重点阐述其关键路径的性能监控体系。文档将详细说明基线性能测试、大规模插入吞吐量测试以及属性索引查询性能评估的方法论。通过这些测试，贡献者可以系统地识别性能瓶颈，并量化不同配置（如压缩算法、WAL模式）对运行效率的影响。最终目标是为持续优化提供可靠的数据支持，并指导开发者如何运行和提交可对比的性能基准报告。

## 性能监控体系
SynapseDB 构建了一套分层且全面的性能监控体系，该体系由多个独立但相互关联的测试模块组成，覆盖了从核心数据操作到高级图算法的各个方面。

整个体系的核心是位于 `src/benchmark` 目录下的标准化框架。该框架定义了统一的接口和数据结构，确保所有测试结果具有可比性。`types.ts` 文件中定义了 `BenchmarkResult` 和 `BenchmarkSuite` 等核心类型，规范了测试结果的度量标准，包括执行时间、内存使用、操作吞吐量等关键指标。

在实现层面，`runner.ts` 提供了 `BenchmarkRunnerImpl` 类，负责执行测试的预热、多次测量和结果统计，以消除环境波动带来的影响。`reporter.ts` 中的 `BenchmarkReporterImpl` 则负责生成多种格式的报告（控制台、JSON、HTML、CSV），便于分析和存档。

此外，项目根目录下的 `benchmarks` 文件夹包含了多个即用型的 `.mjs` 脚本，它们利用底层框架或直接调用 API，提供了从快速日常检查到综合压力测试的不同粒度的测试方案，构成了一个完整的监控生态。

```mermaid
graph TD