# 09 · 嵌入式脚本与自动化

> 将 CLI 操作纳入运维脚本（cron/CI），或以子进程方式调用。

```ts
import { spawn } from 'node:child_process';

function run(cmd: string, args: string[]) {
  return new Promise<void>((resolve, reject) => {
    const p = spawn(cmd, args, { stdio: 'inherit' });
    p.on('exit', (code) => (code === 0 ? resolve() : reject(new Error(`exit ${code}`))));
  });
}

await run('synapsedb', [
  'auto-compact',
  'prod.synapsedb',
  '--mode=incremental',
  '--orders=SPO',
  '--min-merge=2',
  '--hot-threshold=1',
  '--max-primary=1',
  '--auto-gc',
]);

await run('synapsedb', ['gc', 'prod.synapsedb']);
```

- 也可直接 import 维护模块进行更细粒度控制
