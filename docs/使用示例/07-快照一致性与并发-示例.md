# 07 · 快照一致性与并发

```ts
import { SynapseDB } from 'synapsedb';

const db = await SynapseDB.open('snap.synapsedb');

const results = await db.withSnapshot(async (snap) => {
  return snap.find({ object: 'Target' }).followReverse('HAS_METHOD').followReverse('DEFINES').all();
});

console.log('results in snapshot:', results.length);
await db.close();
```

要点

- `withSnapshot(fn)`：固定 manifest epoch，避免 compact/GC 并发影响本次链路
